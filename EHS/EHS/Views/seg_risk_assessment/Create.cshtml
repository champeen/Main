@model EHS.ViewModels.SegViewModel

@{
    ViewData["Title"] = "Create Qualitive Exposure Assessment";
}

<div class="py-4">
    <div class="card shadow rounded-4">
        <div class="card-body">
            <h2 class="card-title mb-4">Create Qualitive Exposure Assessment</h2>
            <form asp-action="Create" class="needs-validation" novalidate>
                @Html.HiddenFor(m => m.seg_risk_assessment.created_user)
                @Html.HiddenFor(m => m.seg_risk_assessment.created_user_fullname)
                @Html.HiddenFor(m => m.seg_risk_assessment.created_user_email)
                @Html.HiddenFor(m => m.seg_risk_assessment.created_date)
                @Html.HiddenFor(m => m.Username)

                <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

                <fieldset class="border p-3 mb-4 rounded">
                    <legend class="float-none w-auto px-2">Similar Exposure Group</legend>
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.location" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.location, new SelectList(ViewBag.Locations, "Value", "Text"), "-- Select Location --", new { @class = "form-control select2-single", @id = "SegCreateLocations" })
                            <span asp-validation-for="seg_risk_assessment.location" class="text-danger"></span>
                        </div>

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.exposure_type" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.exposure_type, new SelectList(ViewBag.ExposureTypes, "Value", "Text"), "-- Select Exposure Type --", new { @class = "form-control select2-single", @id = "SegCreateExposureTypes" })
                            <span asp-validation-for="seg_risk_assessment.exposure_type" class="text-danger"></span>
                        </div>

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.agent" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.agent, new SelectList(ViewBag.Agents, "Value", "Text"), "-- Select Agent --", new { @class = "form-control select2-single", @id = "SegCreateAgents" })
                            <span asp-validation-for="seg_risk_assessment.agent" class="text-danger"></span>
                        </div>

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.role" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.role, new SelectList(ViewBag.SegRoles, "Value", "Text"), "-- Select Role --", new { @class = "form-control select2-single", @id = "SegCreateRole" })
                            <span asp-validation-for="seg_risk_assessment.role" class="text-danger"></span>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="border p-3 mb-4 rounded">
                    <legend class="float-none w-auto px-2">Task Information</legend>
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.task" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.task, new SelectList(ViewBag.Tasks, "Value", "Text"), "-- Select Task --", new { @class = "form-control select2-single", @id = "SegCreateTask" })
                            <span asp-validation-for="seg_risk_assessment.task" class="text-danger"></span>
                        </div>

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.frequency_of_task" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.frequency_of_task, new SelectList(ViewBag.FrequencyOfTask, "Value", "Text"), "-- Select FrequencyOfTask --", new { @class = "form-control select2-single", @id = "SegCreateFrequencyOfTask" })
                            <span asp-validation-for="seg_risk_assessment.frequency_of_task" class="text-danger"></span>
                        </div>

                        <div class="col-md-6">
                            <label class="form-label fw-bold">Duration of Task (Days / Hours / Minutes)</label>
                            <div class="row g-2">
                                <div class="col">
                                    <input asp-for="DurationDays" class="form-control" placeholder="Days" />
                                </div>
                                <div class="col">
                                    <input asp-for="DurationHours" class="form-control" placeholder="Hours" />
                                </div>
                                <div class="col">
                                    <input asp-for="DurationMinutes" class="form-control" placeholder="Minutes" />
                                </div>
@*                                 <div class="col">
                                    <input asp-for="DurationSeconds" class="form-control" placeholder="Seconds" />
                                </div> *@
                            </div>
                            <div>
                                <span asp-validation-for="DurationDays" class="text-danger"></span>
                                <span asp-validation-for="DurationHours" class="text-danger"></span>
                                <span asp-validation-for="DurationMinutes" class="text-danger"></span>
                                @* <span asp-validation-for="DurationSeconds" class="text-danger"></span> *@
                            </div>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="border p-3 mb-4 rounded">
                    <legend class="float-none w-auto px-2">Additional Information</legend>
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.oel" class="form-label fw-bold"></label>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.oel, new SelectList(ViewBag.OccupationalExposureLimits, "Value", "Text"), "-- Select OEL --", new { @class = "form-control select2-single", @id = "SegCreateOel" })
                            <span asp-validation-for="seg_risk_assessment.oel" class="text-danger"></span>
                        </div>

@*                         <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.acute_chronic" class="form-label fw-bold"></label>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.acute_chronic, new SelectList(ViewBag.AcuteChronic, "Value", "Text"), "-- Select Acute/Chronic --", new { @class = "form-control select2-single", @id = "SegCreateAcuteChronic" })
                            <span asp-validation-for="seg_risk_assessment.acute_chronic" class="text-danger"></span>
                        </div> *@

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.route_of_entry" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            <i class="bi bi-info-circle-fill" style="color:blue;" data-bs-toggle="tooltip" title="Multi-Select"></i>
                            @Html.ListBoxFor(m => m.seg_risk_assessment.route_of_entry, new MultiSelectList(ViewBag.RouteOfEntry, "Value", "Text"), new { @class = "form-control select2-multiple", @id = "SegCreateRouteOfEntry", multiple = true })
                            <span asp-validation-for="seg_risk_assessment.route_of_entry" class="text-danger"></span>
                        </div>

@*                         <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.monitoring_data_required" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.monitoring_data_required, new SelectList(ViewBag.MonitoringDataRequired, "Value", "Text"), "-- Select Monitoring Data Required --", new { @class = "form-control select2-single", @id = "SegCreateMonitoringDataRequired" })
                            <span asp-validation-for="seg_risk_assessment.monitoring_data_required" class="text-danger"></span>
                        </div> *@

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.controls_recommended" class="form-label fw-bold"></label>
                            <i class="bi bi-info-circle-fill" style="color:blue;" data-bs-toggle="tooltip" title="Multi-Select"></i>
                            @Html.ListBoxFor(m => m.seg_risk_assessment.controls_recommended, new MultiSelectList(ViewBag.ControlsRecommended, "Value", "Text"), new { @class = "form-control select2-multiple", @id = "SegCreateControlRecommended", multiple = true })
                            <span asp-validation-for="seg_risk_assessment.controls_recommended" class="text-danger"></span>
                        </div>

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.exposure_levels_acceptable" class="form-label fw-bold"></label>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.exposure_levels_acceptable, new SelectList(ViewBag.YesNo, "Value", "Text"), "-- Select Yes/No --", new { @class = "form-control select2-single", @id = "SegCreateYesNo" })
                            <span asp-validation-for="seg_risk_assessment.exposure_levels_acceptable" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.assessment_methods_used" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.assessment_methods_used, new SelectList(ViewBag.AssessmentMethodsUsed, "Value", "Text"), "-- Select Assessment Methods Used --", new { @class = "form-control select2-single", @id = "SegCreateAssessmentMethodsUsed" })
                            <span asp-validation-for="seg_risk_assessment.assessment_methods_used" class="text-danger"></span>
                        </div>

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.seg_number_of_workers" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.seg_number_of_workers, new SelectList(ViewBag.NumberOfWorkers, "Value", "Text"), "-- Select Number of Workers --", new { @class = "form-control select2-single", @id = "SegCreateNumberOfWorkers" })
                            <span asp-validation-for="seg_risk_assessment.seg_number_of_workers" class="text-danger"></span>
                        </div>

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.has_agent_been_changed" class="form-label fw-bold"></label>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.has_agent_been_changed, new SelectList(ViewBag.HasAgentBeenChanged, "Value", "Text"), "-- Select --", new { @class = "form-control select2-single", @id = "SegCreateHasAgentBeenChanged" })
                            <span asp-validation-for="seg_risk_assessment.has_agent_been_changed" class="text-danger"></span>
                        </div>

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.person_performing_assessment_username" class="form-label fw-bold"></label>
                            <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" title="Required"></i>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.person_performing_assessment_username, new SelectList(ViewBag.Employees, "Value", "Text"), "-- Select Employee --", new { @class = "form-control select2-single", @id = "SegCreatePersonPerformingAssessment" })
                            <span asp-validation-for="seg_risk_assessment.person_performing_assessment_username" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.date_conducted" class="form-label fw-bold"></label>
                            <input asp-for="seg_risk_assessment.date_conducted" type="text" class="form-control datepicker" placeholder="Select date..." />
                            <span asp-validation-for="seg_risk_assessment.date_conducted" class="text-danger"></span>
                        </div>

                        <div class="col-md-3">
                            <label asp-for="seg_risk_assessment.date_reviewed" class="form-label fw-bold"></label>
                            <input asp-for="seg_risk_assessment.date_reviewed" type="text" class="form-control datepicker" placeholder="Select date..." />
                            <span asp-validation-for="seg_risk_assessment.date_reviewed" class="text-danger"></span>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="border p-3 mb-4 rounded">
                    <legend class="float-none w-auto px-2">Risk Rating</legend>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label asp-for="seg_risk_assessment.exposure_rating" class="form-label fw-bold"></label>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.exposure_rating, new SelectList(ViewBag.ExposureRatings, "Value", "Text"), "-- Select Rating --", new { @class = "form-control select2-single", @id = "SegCreateExposureRating" })
                            <span asp-validation-for="seg_risk_assessment.exposure_rating" class="text-danger"></span>
                        </div>
                        <div class="col-md-6">
                            <label asp-for="seg_risk_assessment.health_effect_rating" class="form-label fw-bold"></label>
                            @Html.DropDownListFor(m => m.seg_risk_assessment.health_effect_rating, new SelectList(ViewBag.HealthEffectRatings, "Value", "Text"), "-- Select Rating --", new { @class = "form-control select2-single", @id = "SegCreateHealthEffectRating" })
                            <span asp-validation-for="seg_risk_assessment.health_effect_rating" class="text-danger"></span>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="border p-3 mb-4 rounded">
                    <legend class="float-none w-auto px-2">Notes</legend>
                    <div class="row">
                        <div class="col-md-12">
                            <label asp-for="seg_risk_assessment.additional_notes" class="form-label fw-bold"></label>
                            @Html.TextAreaFor(m => m.seg_risk_assessment.additional_notes, new { id = "editorSegRiskAssessmentNotes", @class = "form-control", @rows = 3 })
                            <span asp-validation-for="seg_risk_assessment.additional_notes" class="text-danger"></span>
                        </div>
                    </div>
                </fieldset>

                <div class="mt-4 d-flex justify-content-between">
                    <a asp-action="Index" class="btn btn-outline-secondary">Cancel</a>
                    <button type="submit" class="btn btn-success px-4">Create</button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(function () {
            const selects = [
                "#SegCreatePersonPerformingAssessment", "#SegCreateLocations", "#SegCreateExposureTypes",
                "#SegCreateAgents", "#SegCreateRole", "#SegCreateTask", "#SegCreateOel",
                "#SegCreateAcuteChronic", "#SegCreateRouteOfEntry", "#SegCreateFrequencyOfTask",
                "#SegCreateMonitoringDataRequired", "#SegCreateControlRecommended",
                "#SegCreateYesNo", "#SegCreateAssessmentMethodsUsed",
                "#SegCreateNumberOfWorkers", "#SegCreateHasAgentBeenChanged",
                "#SegCreateExposureRating", "#SegCreateHealthEffectRating"
            ];

            selects.forEach(function (id) {
                $(id).select2({
                    placeholder: $(id + " option:first").text(),
                    allowClear: true,
                    width: '100%'
                });
            });

            $('#SegCreateExposureTypes').on('change', function () {
                const exposureType = $(this).val();
                $.getJSON('/seg_risk_assessment/GetAgentByExposureType', { exposureType }, function (data) {
                    const agentSelect = $('#SegCreateAgents');
                    agentSelect.empty().append('<option value="">-- Select Agent --</option>');
                    $.each(data, function (i, agent) {
                        agentSelect.append(`<option value="${agent.description}">${agent.description}</option>`);
                    });
                });
            });
        });
    </script>

    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}




@* @model EHS.ViewModels.SegViewModel

@{
    ViewData["Title"] = "Create Risk Assessment";
}

<div class="container-fluid py-4">
    <div class="card shadow rounded-4">
        <div class="card-body">
            <h2 class="card-title mb-4">Create New Risk Assessment</h2>
            <form asp-action="Create" class="needs-validation" novalidate>
                @Html.HiddenFor(m => m.seg_risk_assessment.created_user)
                @Html.HiddenFor(m => m.seg_risk_assessment.created_user_fullname)
                @Html.HiddenFor(m => m.seg_risk_assessment.created_user_email)
                @Html.HiddenFor(m => m.seg_risk_assessment.created_date)
                @Html.HiddenFor(m => m.Username)
                <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>
                <div class="row g-3">
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.location" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.location, new SelectList(ViewBag.Locations, "Value", "Text"), "-- Select Location --", new { @class = "form-control select2-single", @id = "SegCreateLocations" })
                        <span asp-validation-for="seg_risk_assessment.location" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.exposure_type" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.exposure_type, new SelectList(ViewBag.ExposureTypes, "Value", "Text"), "-- Select Exposure Type --", new { @class = "form-control select2-single", @id = "SegCreateExposureTypes" })
                        <span asp-validation-for="seg_risk_assessment.exposure_type" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.agent" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.agent, new SelectList(ViewBag.Agents, "Value", "Text"), "-- Select Agent --", new { @class = "form-control select2-single", @id = "SegCreateAgents" })
                        <span asp-validation-for="seg_risk_assessment.agent" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.seg_role" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.seg_role, new SelectList(ViewBag.SegRoles, "Value", "Text"), new { @class = "form-control select2-single", @id = "SegCreateRole" })
                        <span asp-validation-for="seg_risk_assessment.seg_role" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.task" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.task, new SelectList(ViewBag.Tasks, "Value", "Text"), new { @class = "form-control select2-single", @id = "SegCreateTask" })
                        <span asp-validation-for="seg_risk_assessment.task" class="text-danger"></span>
                    </div>                    
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.frequency_of_task" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.frequency_of_task, new SelectList(ViewBag.FrequencyOfTask, "Value", "Text"), "-- Select FrequencyOfTask --", new { @class = "form-control select2-single", @id = "SegCreateFrequencyOfTask" })
                        <span asp-validation-for="seg_risk_assessment.frequency_of_task" class="text-danger"></span>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Duration of Task (Days / Hours / Minutes / Seconds)</label>
                        <div class="row g-2">
                            <div class="col">
                                <input asp-for="DurationDays" class="form-control" placeholder="Days" />
                            </div>
                            <div class="col">
                                <input asp-for="DurationHours" class="form-control" placeholder="Hours" />
                            </div>
                            <div class="col">
                                <input asp-for="DurationMinutes" class="form-control" placeholder="Minutes" />
                            </div>
                            <div class="col">
                                <input asp-for="DurationSeconds" class="form-control" placeholder="Seconds" />
                            </div>
                        </div>
                        <div>
                            <span asp-validation-for="DurationDays" class="text-danger"></span>
                            <span asp-validation-for="DurationHours" class="text-danger"></span>
                            <span asp-validation-for="DurationMinutes" class="text-danger"></span>
                            <span asp-validation-for="DurationSeconds" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.oel" class="form-label fw-bold"></label>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.oel, new SelectList(ViewBag.OccupationalExposureLimits, "Value", "Text"), "-- Select OEL --", new { @class = "form-control select2-single", @id = "SegCreateOel" })
                        <span asp-validation-for="seg_risk_assessment.oel" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.acute_chronic" class="form-label fw-bold"></label>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.acute_chronic, new SelectList(ViewBag.AcuteChronic, "Value", "Text"), "-- Select Acute/Chronic --", new { @class = "form-control select2-single", @id = "SegCreateAcuteChronic" })
                        <span asp-validation-for="seg_risk_assessment.acute_chronic" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.route_of_entry" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        <i class="bi bi-info-circle-fill" style="color:blue;" data-bs-toggle="tooltip" data-bs-html="true" title="Multi-Select"></i>
                        @Html.ListBoxFor(model => model.seg_risk_assessment.route_of_entry, new MultiSelectList(ViewBag.RouteOfEntry, "Value", "Text"), new { @class = "form-control select2-multiple", @id = "SegCreateRouteOfEntry", multiple = true })
                        <span asp-validation-for="seg_risk_assessment.route_of_entry" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.monitoring_data_required" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.monitoring_data_required, new SelectList(ViewBag.MonitoringDataRequired, "Value", "Text"), "-- Select Monitoring Data Required --", new { @class = "form-control select2-single", @id = "SegCreateMonitoringDataRequired" })
                        <span asp-validation-for="seg_risk_assessment.monitoring_data_required" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.controls_recommended" class="form-label fw-bold"></label>
                        <i class="bi bi-info-circle-fill" style="color:blue;" data-bs-toggle="tooltip" data-bs-html="true" title="Multi-Select"></i>
                        @Html.ListBoxFor(model => model.seg_risk_assessment.controls_recommended, new MultiSelectList(ViewBag.ControlsRecommended, "Value", "Text"), new { @class = "form-control select2-multiple", @id = "SegCreateControlRecommended", multiple = true })
                        <span asp-validation-for="seg_risk_assessment.controls_recommended" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.exposure_levels_acceptable" class="form-label fw-bold"></label>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.exposure_levels_acceptable, new SelectList(ViewBag.YesNo, "Value", "Text"), "-- Select Yes/No --", new { @class = "form-control select2-single", @id = "SegCreateYesNo" })
                        <span asp-validation-for="seg_risk_assessment.exposure_levels_acceptable" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.date_conducted" class="form-label fw-bold"></label>
                        <input asp-for="seg_risk_assessment.date_conducted" type="text" class="form-control datepicker" placeholder="Select date..." />
                        <span asp-validation-for="seg_risk_assessment.date_conducted" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.assessment_methods_used" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.assessment_methods_used, new SelectList(ViewBag.AssessmentMethodsUsed, "Value", "Text"), "-- Select Assessment Methods Used --", new { @class = "form-control select2-single", @id = "SegCreateAssessmentMethodsUsed" })
                        <span asp-validation-for="seg_risk_assessment.assessment_methods_used" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.seg_number_of_workers" class="form-label fw-bold"></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.seg_number_of_workers, new SelectList(ViewBag.NumberOfWorkers, "Value", "Text"), "-- Select Number of Workers --", new { @class = "form-control select2-single", @id = "SegCreateNumberOfWorkers" })
                        <span asp-validation-for="seg_risk_assessment.seg_number_of_workers" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.has_agent_been_changed" class="form-label fw-bold"></label>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.has_agent_been_changed, new SelectList(ViewBag.HasAgentBeenChanged, "Value", "Text"), "-- Select --", new { @class = "form-control select2-single", @id = "SegCreateHasAgentBeenChanged" })
                        <span asp-validation-for="seg_risk_assessment.has_agent_been_changed" class="text-danger"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.person_performing_assessment_username" class="form-label fw-bold" ></label>
                        <i class="bi bi-r-circle-fill" style="color:red;" data-bs-toggle="tooltip" data-bs-html="true" title="Required"></i>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.person_performing_assessment_username, new SelectList(ViewBag.Employees, "Value", "Text"), "-- Select Employee --", new { @class = "form-control select2-single", @id = "SegCreatePersonPerformingAssessment" })
                        <span asp-validation-for="seg_risk_assessment.person_performing_assessment_username" class="text-danger"></span>
                    </div>

                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.exposure_rating" class="form-label fw-bold"></label>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.exposure_rating, new SelectList(ViewBag.ExposureRatings, "Value", "Text"), "-- Select Rating --", new { @class = "form-control select2-single", @id = "SegCreateExposureRating" })
                        <span asp-validation-for="seg_risk_assessment.exposure_rating" class="text-danger"></span>
                    </div>

                    <div class="col-md-3">
                        <label asp-for="seg_risk_assessment.health_effect_rating" class="form-label fw-bold"></label>
                        @Html.DropDownListFor(model => model.seg_risk_assessment.health_effect_rating, new SelectList(ViewBag.HealthEffectRatings, "Value", "Text"), "-- Select Rating --", new { @class = "form-control select2-single", @id = "SegCreateHealthEffectRating" })
                        <span asp-validation-for="seg_risk_assessment.health_effect_rating" class="text-danger"></span>
                    </div>

                    <div class="col-md-12">
                        <label asp-for="seg_risk_assessment.additional_notes" class="form-label fw-bold"></label>
                        @Html.TextAreaFor(model => model.seg_risk_assessment.additional_notes, new { id = "editorSegRiskAssessmentNotes", @class = "form-control", @rows = 3 })
                        <span asp-validation-for="seg_risk_assessment.additional_notes" class="text-danger"></span>
                    </div>
                </div>
                <div class="mt-4 d-flex justify-content-between">
                    <a asp-action="Index" class="btn btn-outline-secondary">Cancel</a>
                    <button type="submit" class="btn btn-primary px-4">Save</button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(function () {
            $('#SegCreatePersonPerformingAssessment').select2({
                placeholder: "-- Select Employee --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateLocations').select2({
                placeholder: "-- Select Location --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateExposureTypes').select2({
                placeholder: "-- Select Exposure Type --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateAgents').select2({
                placeholder: "-- Select Agent --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateRole').select2({
                placeholder: "-- Select Role --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateTask').select2({
                placeholder: "-- Select Task --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateOel').select2({
                placeholder: "-- Select OEL --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateAcuteChronic').select2({
                placeholder: "-- Select Acute/Chronic --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateRouteOfEntry').select2({
                placeholder: "-- Select Route of Entry --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateFrequencyOfTask').select2({
                placeholder: "-- Select Frequency of Task --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateMonitoringDataRequired').select2({
                placeholder: "-- Select Monitoring Data Required --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateControlRecommended').select2({
                placeholder: "-- Select Control Recommended --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateYesNo').select2({
                placeholder: "-- Select Yes/No --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateAssessmentMethodsUsed').select2({
                placeholder: "-- Select Assessment Methods Used --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateNumberOfWorkers').select2({
                placeholder: "-- Select Number of Workers --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateHasAgentBeenChanged').select2({
                placeholder: "-- Select --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateExposureRating').select2({
                placeholder: "-- Select --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
            $('#SegCreateHealthEffectRating').select2({
                placeholder: "-- Select --",
                allowClear: true,
                width: '100%' // ensures consistent layout
            });
        });

        // prefill agent dropdown based on exposure_type dropdown selection.....
        $('#SegCreateExposureTypes').on('change', function () {
            const exposureType = $(this).val();
            $.getJSON('/seg_risk_assessment/GetAgentByExposureType', { exposureType }, function (data) {
                const agentSelect = $('#SegCreateAgents');
                agentSelect.empty().append('<option value="">-- Select Agent --</option>');
                $.each(data, function (i, agent) {
                    agentSelect.append(`<option value="${agent.description}">${agent.description}</option>`);
                });
            });

            // this will unhide the agent field once an exposure type is selected....
            //const show = $(this).val() !== "";
            //$('#agent-container').collapse(show ? 'show' : 'hide');
        });
    </script>

    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}  *@